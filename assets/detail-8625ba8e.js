import{_ as I,aA as O,b6 as v,r as P,m,b as h,c as b,i as w,f as p,g as n,w as s,a as t,F as y,bj as T,X as d,Y as U,Z as D,$ as E,A as f,a0 as c,W as x,K as G,L as W,bi as X,ax as g}from"./index-0666afcb.js";import"./AvatarCropper.vue_vue_type_style_index_0_scoped_9728916b_lang-08fe2d60.js";const k=r=>(G("data-v-32bfa2f0"),r=r(),W(),r),S=k(()=>p("h3",{class:"title"},"配置信息",-1)),C={class:"view-box"},R={class:"container el-container"},K={class:"el-main",style:{"padding-right":"20px"}},Y={__name:"detail",setup(r){O(),v(),P(!1);const e=m({AUTOQA_AUTOREPLY:"0",WXOPENAI_TOKEN:"",WXOPENAI_ENCODINGAESKEY:"",WXOPENAI_APPID:"",WXOPENAI_MANAGERID:"",loading:!1}),i=m({});function A(){T().then(({data:u})=>{console.log("ServeGetUserConfigGroup",u),console.log("ServeGetUserConfigGroup",u.智能问答),console.log("ServeGetUserConfigGroup",u.微信对话开放平台);const l=u.智能问答;e[l[0].key]=l[0].value===!0?"1":"0",i[l[0].key]=l[0];const a=u.微信对话开放平台;for(let o=0;o<a.length;o++)i[a[o].key]=a[o],e[a[o].key]=a[o].value;console.log("configMap",i),console.log("detail",e)})}A();const N=()=>{if(console.log("detail",e),!e.WXOPENAI_TOKEN||!e.WXOPENAI_ENCODINGAESKEY||!e.WXOPENAI_APPID||!e.WXOPENAI_MANAGERID)return window.$message.warning("必填项不能为空");e.loading=!0;const u=[];for(const a in e){console.debug("key",a),console.debug("configMap[key]",i[a]),console.debug("detail[key]",e[a]);const o=new Date().getTime();if(a!=="loading"){a==="AUTOQA_AUTOREPLY"?(e[a]=e[a]==="1"?"true":"false",i[a].name="智能问答-"+i[a].name):i[a].name="微信对话开放平台-"+i[a].name,i[a].lastOperationTime=o;const _={recordId:i[a].id,fields:i[a]};_.fields.value=e[a],delete _.fields.id,u.push(_)}}console.log("config",u);const l=X(u);l.then(()=>{window.$message.success("信息保存成功");const a={app:"智能问答|qa",type:"env",action:"reload"},o=g.formatMsgToCommand(a);g.client.publish(g.apis.commandApi,o),A()}),l.catch(()=>{window.$message.warning("信息保存失败")}),l.finally(()=>{e.loading=!1})};return(u,l)=>{const a=h("n-button");return b(),w(y,null,[S,p("div",C,[p("section",R,[p("main",K,[n(t(x),{ref:"formRef","label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging",size:"medium",style:{"max-width":"500px","margin-top":"25px"}},{default:s(()=>[n(t(d),{label:"自动问答："},{default:s(()=>[n(t(U),{value:e.AUTOQA_AUTOREPLY,"onUpdate:value":l[0]||(l[0]=o=>e.AUTOQA_AUTOREPLY=o),name:"AUTOQA_AUTOREPLY"},{default:s(()=>[n(t(D),null,{default:s(()=>[n(t(E),{key:"1",value:"1"},{default:s(()=>[f(" 开启 ")]),_:1}),n(t(E),{key:"0",value:"0"},{default:s(()=>[f(" 关闭 ")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),n(t(d),{label:"Token："},{default:s(()=>[n(t(c),{placeholder:"请输入微信对话平台token",value:e.WXOPENAI_TOKEN,"onUpdate:value":l[1]||(l[1]=o=>e.WXOPENAI_TOKEN=o),maxlength:"20","show-count":""},null,8,["value"])]),_:1}),n(t(d),{label:"EncodingAESKey："},{default:s(()=>[n(t(c),{placeholder:"请输入微信对话平台密钥",value:e.WXOPENAI_ENCODINGAESKEY,"onUpdate:value":l[2]||(l[2]=o=>e.WXOPENAI_ENCODINGAESKEY=o),maxlength:"20","show-count":""},null,8,["value"])]),_:1}),n(t(d),{label:"APPID"},{default:s(()=>[n(t(c),{placeholder:"请输入微信对话平台APPID",value:e.WXOPENAI_APPID,"onUpdate:value":l[3]||(l[3]=o=>e.WXOPENAI_APPID=o),maxlength:"20","show-count":""},null,8,["value"])]),_:1}),n(t(d),{label:"管理员ID"},{default:s(()=>[n(t(c),{placeholder:"请输入微信对话平台管理员ID",value:e.WXOPENAI_MANAGERID,"onUpdate:value":l[4]||(l[4]=o=>e.WXOPENAI_MANAGERID=o),maxlength:"20","show-count":""},null,8,["value"])]),_:1}),n(t(d),null,{default:s(()=>[n(a,{type:"primary",onClick:N,loading:e.loading,style:{"margin-left":"94px"}},{default:s(()=>[f(" 保存修改 ")]),_:1},8,["loading"])]),_:1})]),_:1},512)])])])],64)}}},Q=I(Y,[["__scopeId","data-v-32bfa2f0"]]);export{Q as default};
