import{a0 as W,a1 as n,a2 as E,q as T,ae as O,o as _e,a4 as V,a5 as a,ai as D,aA as M,a7 as t,a9 as j,a8 as i,a6 as k,$ as N,ah as B,aa as f,ab as b,ac as S,bg as ce,aD as ke,bh as me,bi as ve,bj as fe,bk as we,bl as ge,bm as pe,at as U,au as R,bn as P,aL as te,al as A,ap as ie,ad as q,bo as ye,an as xe,w as J,x as Le,bp as Ce,bq as de,s as X,ao as $e,br as be,am as Me,bs as ze,X as se,bt as Se,bu as je,bv as Ne,bw as Ve,aj as Ie}from"./index-6a9cab4f.js";import{_ as ne}from"./no-data-bde0995b.js";import{L as Q}from"./Loading-85aa316d.js";import{N as re}from"./Image-6348005d.js";import{a as le,U as We}from"./UploadOne-47b02a49.js";import{I as ee,P as De}from"./Plus-d9b3a3cd.js";import{D as Ae,S as He}from"./Share-624a7480.js";import{N as ue}from"./Scrollbar-dc531417.js";import{S as Be}from"./Search-214e7cb3.js";import{f as Fe}from"./strings-8042df5b.js";import{C as Te}from"./Close-f1b6438a.js";import"./ImageGroup-762af646.js";const Ee=W("calendar-thirty",!0,function(e){return n("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[n("rect",{x:"4",y:"4",width:"40",height:"40",rx:"2",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M4 14H44",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("line",{x1:"4",y1:"11",x2:"4",y2:"23",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("line",{x1:"44",y1:"11",x2:"44",y2:"23",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M28 22V36H36V22H28Z",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M12 22H20V36H12",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M20 29H14",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Ue=W("download-four",!1,function(e){return n("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[n("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M23.9999 29.0001L12 17.0001L19.9999 17.0001L19.9999 6.00011L27.9999 6.00011L27.9999 17.0001L35.9999 17.0001L23.9999 29.0001Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M42 37L6 37",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap},null),n("path",{d:"M34 44H14",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap},null)])}),ae=W("edit-one",!0,function(e){return n("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[n("path",{d:"M29 4H9C7.89543 4 7 4.89543 7 6V42C7 43.1046 7.89543 44 9 44H37C38.1046 44 39 43.1046 39 42V20.0046",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M13 18H21",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap},null),n("path",{d:"M13 28H25",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap},null),n("path",{d:"M40.9991 6.00098L29.0044 17.9958",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Re=W("folder-focus",!0,function(e){return n("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[n("path",{d:"M5 8C5 6.89543 5.89543 6 7 6H19L24 12H41C42.1046 12 43 12.8954 43 14V40C43 41.1046 42.1046 42 41 42H7C5.89543 42 5 41.1046 5 40V8Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M24 20L26.243 24.9128L31.6085 25.5279L27.6292 29.1792L28.7023 34.4721L24 31.816L19.2977 34.4721L20.3708 29.1792L16.3915 25.5279L21.757 24.9128L24 20Z",fill:e.colors[3],stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Ze=W("full-screen",!1,function(e){return n("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[n("path",{d:"M33 6H42V15",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M42 33V42H33",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M15 42H6V33",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M6 15V6H15",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Ke=W("label",!1,function(e){return n("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[n("path",{d:"M9 4H39V44L24 33.4286L9 44V4Z",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("rect",{x:"9",y:"4",width:"30",height:"12",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Xe=W("off-screen",!1,function(e){return n("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[n("path",{d:"M33 6V15H42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M15 6V15H6",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M15 42V33H6",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M33 42V33H41.8995",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Pe=W("sort-amount-down",!0,function(e){return n("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[n("path",{d:"M23 8H43",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M14 41L6 33",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M14 7V41",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M23 18H39",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M23 28H35",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M23 38H31",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Ye=W("star",!1,function(e){return n("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[n("path",{d:"M23.9986 5L17.8856 17.4776L4 19.4911L14.0589 29.3251L11.6544 43L23.9986 36.4192L36.3454 43L33.9586 29.3251L44 19.4911L30.1913 17.4776L23.9986 5Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null)])}),qe=W("to-bottom",!1,function(e){return n("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[n("path",{d:"M24.0083 33.8995V6",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M36 22L24 34L12 22",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),n("path",{d:"M36 42H12",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])});const G=e=>(U("data-v-09eb5c64"),e=e(),R(),e),Oe={class:"main-box el-container is-vertical o-hidden"},Ge={class:"el-header bdr-b header",style:{height:"50px"}},Je={class:"type-items"},Qe={style:{display:"flex","align-items":"center"}},et=G(()=>t("img",{src:ne,alt:""},null,-1)),tt={class:"at-header"},nt={class:"at-name"},ot={class:"text-ellipsis"},it={class:"at-tool"},st=G(()=>t("div",{class:"tip"},"剩余15天",-1)),lt={class:"icons"},at={class:"at-body pointer"},ct={class:"content"},dt={class:"datetime"},rt={class:"abstract"},ut={class:"image"},ht=G(()=>t("img",{src:ne,alt:""},null,-1)),_t={class:"at-header"},kt={class:"at-name"},mt={class:"text-ellipsis"},vt={class:"at-tool"},ft={class:"tip"},wt={class:"icons"},gt={class:"at-body pointer"},pt={class:"content"},yt={class:"abstract"},xt=G(()=>t("footer",{class:"el-footer footer"},"移动至回收站的笔记及附件，将在 30 天后自动清除。",-1)),Lt={__name:"RecycleModal",emits:["close"],setup(e,{emit:o}){const w=o,d=T(!0),s=O({note:{loading:!1,items:[]},annex:{loading:!1,items:[]}}),h=T(1),p=()=>{w("close")},g=$=>{h.value=$},_=()=>{s.note.loading=!0,me({page:1,find_type:5}).then($=>{s.note.items=$.data.items}).finally(()=>{s.note.loading=!1})},y=()=>{s.annex.loading=!0,ve().then($=>{$.code==200&&(s.annex.items=$.data.items||[])}).finally(()=>{s.annex.loading=!1})},C=($,z)=>{fe({article_id:z}).then(l=>{l.code==200&&s.note.items.splice($,1)})},F=($,z)=>{we({article_id:z}).then(l=>{l.code==200&&s.note.items.splice($,1)})},Z=($,z)=>{ge({annex_id:data.id}).then(l=>{l.code==200&&s.annex.items.splice($,1)})},Y=($,z)=>{pe({annex_id:z}).then(l=>{l.code==200&&s.annex.items.splice($,1)})};return _e(()=>{_(),y()}),($,z)=>{const l=V("n-icon"),r=V("n-empty");return a(),D(i(ke),{show:d.value,"onUpdate:show":z[2]||(z[2]=m=>d.value=m),preset:"card",title:"回收站管理",class:"modal-radius",style:{"max-width":"750px"},"on-after-leave":p,segmented:{content:!0},"header-style":{padding:"20px 15px"},"content-style":{padding:0}},{default:M(()=>[t("section",Oe,[t("header",Ge,[t("div",Je,[t("span",{class:j({active:h.value==1}),onClick:z[0]||(z[0]=m=>g(1))}," 笔记列表 ",2),t("span",{class:j({active:h.value==2}),onClick:z[1]||(z[1]=m=>g(2))}," 附件列表 ",2)]),t("div",Qe,[n(l,{size:20,class:"pointer",component:i(Ee)},null,8,["component"])])]),h.value==1?(a(),k("main",{key:0,class:j(["el-main me-scrollbar me-scrollbar-thumb",{"flex-center":s.note.items.length==0,"main-bag":s.note.items.length>0}])},[s.note.loading?(a(),D(Q,{key:0})):s.note.items.length===0?(a(),D(r,{key:1,size:"200",description:"暂无相关数据"},{icon:M(()=>[et]),_:1})):(a(!0),k(N,{key:2},B(s.note.items,(m,c)=>(a(),k("div",{class:"article",key:m.id},[t("div",tt,[t("div",nt,[t("span",ot,f(m.title),1)]),t("div",it,[st,t("div",lt,[n(l,{size:18,color:"#03a9f4",class:"pointer",component:i(le),onClick:u=>F(c,m.id)},null,8,["component","onClick"]),n(l,{size:18,color:"red",class:"pointer",component:i(ee),onClick:u=>C(c,m.id)},null,8,["component","onClick"])])])]),t("div",at,[t("div",ct,[t("div",dt,[t("span",null,f(m.created_at.substr(0,10)),1),t("span",null,f(m.class_name),1)]),t("div",rt,f(m.abstract.replace(/[\r\n]/g,"").replace(/(<([^>]+)>)/gi,"")),1)]),b(t("div",ut,[n(i(re),{width:"56",height:"56","preview-disabled":"",style:{"border-radius":"2px"},src:m.image,"fallback-src":"https://07akioni.oss-cn-beijing.aliyuncs.com/07akioni.jpeg"},null,8,["src"])],512),[[S,m.image]])])]))),128))],2)):(a(),k("main",{key:1,class:j(["el-main me-scrollbar",{"flex-center":s.annex.items.length==0,"main-bag":s.annex.items.length>0}])},[s.annex.loading?(a(),D(Q,{key:0})):s.annex.items.length==0?(a(),D(r,{key:1,size:"200",description:"暂无相关数据"},{icon:M(()=>[ht]),_:1})):(a(!0),k(N,{key:2},B(s.annex.items,(m,c)=>(a(),k("div",{class:"article",key:m.id},[t("div",_t,[t("div",kt,[t("span",mt,f(m.original_name),1)]),t("div",vt,[t("div",ft,"剩余"+f(m.day)+"天",1),t("div",wt,[n(l,{size:18,color:"#03a9f4",class:"pointer",component:i(qe),onClick:u=>i(ce)(m.id)},null,8,["component","onClick"]),n(l,{size:18,color:"#03a9f4",class:"pointer",component:i(le),onClick:u=>Z(c,m.id)},null,8,["component","onClick"]),n(l,{size:18,color:"red",class:"pointer",component:i(ee),onClick:u=>Y(c,m.id)},null,8,["component","onClick"])])])]),t("div",gt,[t("div",pt,[t("div",yt,"所属笔记："+f(m.title),1)])])]))),128))],2)),xt])]),_:1},8,["show"])}}},Ct=E(Lt,[["__scopeId","data-v-09eb5c64"]]);const he=e=>(U("data-v-0a8fbbff"),e=e(),R(),e),$t={class:"el-container is-vertical section"},bt={class:"el-header menu-header"},Mt={class:"el-header menu-subheader"},zt=he(()=>t("span",null,"我的笔记",-1)),St={class:"el-main height100"},jt=["onClick"],Nt=he(()=>t("span",{class:"dot"},"●",-1)),Vt=["onClick"],It={key:0},Wt=["value","onBlur"],Dt=["onContextmenu"],At={key:0},Ht={__name:"NoteMenu",setup(e){const o=P();let w=T("0-0");const d=O([{name:"近期编辑",indexName:"0-0",submenus:[]},{name:"我的收藏",indexName:"1-0",submenus:[]},{name:"笔记分类",indexName:"2-1",isShowSub:!0,isShowCount:!0,isSubNode:!0,submenus:[]},{name:"笔记标签",indexName:"3-0",isShowSub:!1,isShowCount:!0,isSubNode:!0,submenus:[]}]),s=T(!1),h=O({options:[],show:!1,dropdownX:0,dropdownY:0,item:{}}),p=()=>{J(()=>o.class,()=>{let l=[];for(const r of o.class)l.push({id:r.id,name:r.class_name,count:r.count,isEdit:!1,indexName:"2-"+r.id});d[2].submenus=l},{deep:!0})},g=()=>{J(()=>o.tags,()=>{let l=[];for(const r of o.tags)l.push({id:r.id,name:r.tag_name,count:r.count,isEdit:!1,indexName:"3-"+r.id});d[3].submenus=l},{deep:!0})},_=()=>{let l=w.value;return l.substring(0,1)!="2"?0:parseInt(l.substring(2))},y=(l,r)=>{if(l.isSubNode)l.isShowSub=!l.isShowSub;else switch(w.value=l.indexName,r){case 0:o.loadNoteList({page:1,find_type:1});break;case 1:o.loadNoteList({page:1,find_type:2});break}},C=(l,r)=>{l.isEdit||(r===2?o.loadNoteList({page:1,find_type:3,cid:l.id}):r===3&&o.loadNoteList({page:1,find_type:4,cid:l.id}),w.value=l.indexName)},F=l=>{l=="class"?(d[2].isShowSub=!0,d[2].submenus.unshift({id:-1,name:"",isEdit:!0,indexName:"2--1"})):l=="tag"&&(d[3].isShowSub=!0,d[3].submenus.unshift({id:-1,name:"",isEdit:!0,indexName:"3--1"}))},Z=(l,r,m,c)=>{let u=l.target.value.trim(),v=c.id==-1?0:c.id;if(u==""&&c.id==-1)return d[r].submenus.splice(m,1);if(u==""&&c.id>0)return c.isEdit=!1;r==2?o.editClass(v,u):r==3&&o.editTag(v,u)},Y=(l,r,m,c)=>{h.show=!1,h.item={index:r,index2:m,submenu:c},h.options=[{label:"重命名",key:"rename"},{label:"删除",key:"delete"}],Le(()=>{h.show=!0,h.dropdownX=l.clientX,h.dropdownY=l.clientY}),l.preventDefault()},$=l=>{let r=d[h.item.index].submenus[h.item.index2];l=="rename"?r.isEdit=!0:l=="delete"&&(h.item.index==2?o.deleteClass(r.id):h.item.index==3&&o.deleteTag(r.id)),h.show=!1};return(()=>{o.loadClass(),o.loadTags(),o.loadNoteList({},!0)})(),p(),g(),(l,r)=>{const m=V("n-button"),c=V("n-icon"),u=te("focus");return a(),k(N,null,[t("section",$t,[t("header",bt,[n(m,{type:"primary",round:"",onClick:r[0]||(r[0]=()=>{i(o).addNewNote(_())}),class:"btn-add"},{default:M(()=>[A(" + 新建笔记 ")]),_:1}),n(i(ie),{class:"tools-menus",animated:!0,trigger:"click","show-arrow":!1,onSelect:F,options:[{label:"创建分类",key:"class"},{label:"创建标签",key:"tag"}]},{default:M(()=>[n(m,{circle:""},{default:M(()=>[n(c,{size:22,component:i(De)},null,8,["component"])]),_:1})]),_:1})]),t("header",Mt,[zt,t("span",null,[n(m,{type:"primary",size:"tiny",ghost:"",round:"",color:"red",onClick:r[1]||(r[1]=v=>s.value=!0)},{default:M(()=>[A(" 回收站 ")]),_:1})])]),t("main",St,[n(i(ue),null,{default:M(()=>[(a(!0),k(N,null,B(d,(v,L)=>(a(),k("div",{key:L,class:"menu"},[t("div",{class:j(["menu-level1 pointer",{actived:v.indexName==i(w)}]),onClick:x=>y(v,L)},[Nt,t("span",null,[A(f(v.name)+" ",1),v.isShowCount?(a(),k(N,{key:0},[A(" ("+f(v.submenus.length)+") ",1)],64)):q("",!0)]),b(n(c,{class:"nav-icon",size:"18",component:i(Ae)},null,8,["component"]),[[S,v.submenus.length]])],10,jt),(a(!0),k(N,null,B(v.submenus,(x,I)=>b((a(),k("div",{key:I,class:j(["menu-level2 pointer",{actived:x.indexName==i(w)}]),onClick:K=>C(x,L)},[x.isEdit?(a(),k("p",It,[b(t("input",{value:x.name,onKeyup:r[2]||(r[2]=ye(K=>K.target.blur(),["enter"])),onBlur:K=>Z(K,L,I,x),type:"text"},null,40,Wt),[[u]])])):(a(),k("p",{key:1,onContextmenu:xe(K=>Y(K,L,I,x),["prevent"])},[t("span",null,"|- "+f(x.name),1),x.count?(a(),k("span",At,"("+f(x.count)+")",1)):q("",!0)],40,Dt))],10,Vt)),[[S,v.isShowSub]])),128))]))),128))]),_:1})])]),n(i(ie),{show:h.show,x:h.dropdownX,y:h.dropdownY,options:h.options,onSelect:$,onClickoutside:r[3]||(r[3]=()=>{h.show=!1,h.item={}})},null,8,["show","x","y","options"]),s.value?(a(),D(Ct,{key:0,onClose:r[4]||(r[4]=v=>s.value=!1)})):q("",!0)],64)}}},Bt=E(Ht,[["__scopeId","data-v-0a8fbbff"]]);const Ft=e=>(U("data-v-f89eea99"),e=e(),R(),e),Tt={class:"el-container is-vertical section"},Et={class:"el-header search-header"},Ut={class:"icon"},Rt={class:"el-header sub-header"},Zt={class:"menu-icon"},Kt={key:0,class:"el-main height100 flex-center"},Xt={key:1,class:"el-main height100 flex-center"},Pt=Ft(()=>t("img",{src:ne,alt:""},null,-1)),Yt={key:2,class:"el-main"},qt=["onClick"],Ot={class:"article-title"},Gt={class:"article-main pointer"},Jt={class:"content"},Qt={class:"datetime"},en={class:"abstract"},tn={class:"image"},nn={__name:"NoteList",setup(e){const o=P(),w=s=>{o.loadDetail(s.id)},d=de(s=>{o.loadNoteList({},!1)},500);return(s,h)=>{const p=V("n-icon"),g=V("n-empty");return a(),k("section",Tt,[t("header",Et,[t("div",Ut,[n(p,{size:"18",component:i(Be)},null,8,["component"])]),b(t("input",{type:"text",class:"search","onUpdate:modelValue":h[0]||(h[0]=_=>i(o).notes.params.keyword=_),placeholder:"搜索我的笔记 ...",maxlength:"30",onInput:h[1]||(h[1]=(..._)=>i(d)&&i(d)(..._))},null,544),[[Ce,i(o).notes.params.keyword]])]),t("header",Rt,[t("span",null,f(i(o).notes.items.length)+" 篇笔记",1),t("div",Zt,[n(p,{size:"18",component:i(Pe)},null,8,["component"])])]),i(o).notes.loadStatus==0?(a(),k("main",Kt,[n(Q)])):i(o).notes.items.length?(a(),k("main",Yt,[n(i(ue),null,{default:M(()=>[(a(!0),k(N,null,B(i(o).notes.items,_=>(a(),k("div",{class:j(["article",{selectd:i(o).view.loadId==_.id}]),key:_.id,onClick:y=>w(_)},[t("div",Ot,[t("span",null,f(_.title),1)]),t("div",Gt,[t("div",Jt,[t("div",Qt,[t("span",null,f(_.created_at.substr(0,10)),1),t("span",null,f(_.class_name),1)]),t("div",en,f(_.abstract.replace(/[\r\n]/g,"").replace(/(<([^>]+)>)/gi,"")),1)]),b(t("div",tn,[n(i(re),{width:"56",height:"56","preview-disabled":"",style:{"border-radius":"2px"},src:_.image,"fallback-src":"https://07akioni.oss-cn-beijing.aliyuncs.com/07akioni.jpeg"},null,8,["src"])],512),[[S,_.image]])])],10,qt))),128))]),_:1})])):(a(),k("main",Xt,[n(g,{size:"200",description:"暂无相关数据"},{icon:M(()=>[Pt]),_:1})]))])}}},on=E(nn,[["__scopeId","data-v-f89eea99"]]),sn="/assets/md-ae2f16cc.svg";const ln=e=>(U("data-v-afa8b77e"),e=e(),R(),e),an={class:"section"},cn={class:"title"},dn={class:"annex-box"},rn={class:"annex-main me-scrollbar me-scrollbar-thumb"},un={class:"empty-text"},hn={class:"suffix"},_n={class:"content"},kn={class:"filename"},mn={class:"filetool"},vn={class:"size"},fn={class:"tools"},wn={class:"annex-footer"},gn=ln(()=>t("p",{class:"notice-text"},[A("文件大小在5M以内"),t("br"),A("最多可支持上传10个附件")],-1)),pn={__name:"AnnexUploadModal",setup(e){const o=P(),w=X(()=>o.view.detail),d=T(!1);function s(){document.getElementById("upload-annex").click()}async function h(p){if(p.target.files.length==0)return!1;let g=p.target.files[0];if(g.size/(1024*1024)>5)return window.$message.info("笔记附件不能大于5M!"),!1;let _=new FormData;_.append("annex",g),_.append("article_id",w.value.id),d.value=!0;let y=await be(_).finally(()=>d.value=!1);if(y&&y.code==200){let{data:C}=y;o.view.detail.files.push({id:C.id,original_name:C.original_name,created_at:Me(new Date),size:C.size,suffix:C.suffix})}}return(p,g)=>{const _=V("n-button"),y=V("n-icon");return a(),k(N,null,[t("input",{type:"file",id:"upload-annex",onChange:h,style:{display:"none"}},null,32),t("section",an,[t("div",cn,[t("span",null,"附件列表("+f(w.value.files.length)+")",1)]),t("div",dn,[t("div",rn,[b(t("p",un,"暂无附件",512),[[S,w.value.files.length==0]]),(a(!0),k(N,null,B(w.value.files,C=>(a(),k("div",{key:C.id,class:"file-item pointer"},[t("div",hn,f(C.suffix),1),t("div",_n,[t("div",kn,f(C.original_name),1),t("div",mn,[t("span",vn,f(i(Fe)(C.size)),1),t("span",null,f(i($e)(C.created_at)),1),t("div",fn,[n(_,{type:"primary",size:"tiny",text:"",onClick:F=>i(ce)(C.id)},{default:M(()=>[A(" 下载 ")]),_:2},1032,["onClick"])])])])]))),128))]),t("div",wn,[gn,n(_,{type:"primary",size:"medium",loading:d.value,onClick:s},{icon:M(()=>[n(y,{component:i(We)},null,8,["component"])]),default:M(()=>[A(" 上传附件 ")]),_:1},8,["loading"])])])])],64)}}},yn=E(pn,[["__scopeId","data-v-afa8b77e"]]);const oe=e=>(U("data-v-d452caa2"),e=e(),R(),e),xn={class:"tag-box"},Ln=oe(()=>t("div",{class:"header"},[t("span",null,"标签管理")],-1)),Cn={class:"tag-groups"},$n=oe(()=>t("div",{class:"title"},"已选择:",-1)),bn=["onClick"],Mn={class:"icon flex-center"},zn={class:"tag-groups"},Sn=oe(()=>t("div",{class:"title"},"标签栏:",-1)),jn=["onClick"],Nn={__name:"TagsClipModal",setup(e){const o=P();let w=!1;const d=X(()=>{let p=o.view.detail.tags.map(g=>g.id);return o.tags.map(g=>({id:g.id,tag_name:g.tag_name,is_check:p.includes(g.id)}))}),s=(p=[])=>{w=!0,ze({article_id:o.view.detail.id,tags:p}).then(g=>{g.code==200&&(o.view.detail.tags=p.map(_=>({id:_})))}).finally(()=>{w=!1})},h=p=>{if(w)return;let g=d.value.filter(_=>p.id===_.id?!_.is_check:_.is_check);if(!p.is_check&&g.length>5)return window.$message.info("标签不能超过5个");s(g.map(_=>_.id))};return(p,g)=>{const _=V("n-icon");return a(),k("section",xn,[Ln,t("div",Cn,[$n,(a(!0),k(N,null,B(d.value,y=>b((a(),k("p",{key:y.id,class:"tag-item",onClick:C=>h(y)},[t("span",null,f(y.tag_name),1),t("span",Mn,[A("  "),n(_,{size:13,component:i(Te)},null,8,["component"])])],8,bn)),[[S,y.is_check]])),128))]),t("div",zn,[Sn,(a(!0),k(N,null,B(d.value,y=>(a(),k("p",{key:y.id,class:j(["tag-item",{active:y.is_check}]),onClick:C=>h(y)},[t("span",null,f(y.tag_name),1)],10,jn))),128))])])}}},Vn=E(Nn,[["__scopeId","data-v-d452caa2"]]);const H=e=>(U("data-v-63720759"),e=e(),R(),e),In={class:"el-main",style:{padding:"0 5px"}},Wn={class:"el-container is-vertical height100"},Dn={class:"el-header editor-title"},An=H(()=>t("img",{src:sn,class:"icon-svg"},null,-1)),Hn=["contenteditable","textContent"],Bn={key:0,class:"el-header sub-header text-ellipsis"},Fn={class:"el-main",style:{overflow:"auto"}},Tn={class:"el-aside nav-tools"},En=H(()=>t("p",null,"全屏",-1)),Un=H(()=>t("p",null,"编辑",-1)),Rn={key:0},Zn={key:1},Kn=H(()=>t("p",null,"收藏",-1)),Xn=H(()=>t("p",null,"标签",-1)),Pn=H(()=>t("p",null,"附件",-1)),Yn=H(()=>t("p",null,"下载",-1)),qn=H(()=>t("p",null,"删除",-1)),On=H(()=>t("p",null,"分享",-1)),Gn={__name:"NoteView",setup(e){const o=P(),w=T(!1),d=X(()=>o.view.detail),s=O({title:d.value.title,markdown:d.value.md_content,html:d.value.content});J(()=>o.view.detail.id,()=>{s.html=o.view.detail.content,s.markdown=o.view.detail.md_content,s.title=o.view.detail.title});const h=X(()=>o.view.loadStatus),p=T(!1),g=X(()=>o.view.editorMode=="preview"?!1:"plaintext-only"),_=()=>{w.value=!w.value},y=(c,u,v)=>{if(!v.length)return;let L=new FormData;L.append("image",v[0]),Se(L).then(x=>{x.code==200?u({url:x.data.url,desc:v[0].name}):window.$message.info(x.message)})},C=(c,u)=>{s.markdown=c,s.html=u},F=c=>{let u=d.value;if(s.markdown==""&&u.id==0){o.close();return}p.value=!0,je({article_id:u.id,class_id:u.class_id,title:s.title,md_content:s.markdown,content:s.html}).then(v=>{if(v.code!=200)return window.$message.info(v.message);u.id==0?(o.loadClass(),o.loadNoteList({},!1)):o.updateNoteItem(u.id,v.data),o.view.detail.md_content=s.markdown,o.view.detail.content=s.html,o.view.detail.id=v.data.id,c&&o.setEditorMode("preview"),window.$message.success("保存成功",{duration:1e3})}).finally(()=>{p.value=!1})},Z=de(c=>{F(c)},500),Y=c=>{if(c.keyCode==13){c.preventDefault();return}s.title=c.target.innerText,(c.ctrlKey||c.metaKey)&&c.keyCode===83&&(c.preventDefault(),Z(!1))},$=()=>{let c=d.value.is_asterisk==1?2:1;Ne({article_id:d.value.id,type:c}).then(u=>{if(u.code!==200)return!1;o.setCollectionStatus(c==1)})},z=()=>{let c=o.view.detail.title+".md",u=new Blob([o.view.detail.md_content],{type:"text/plain"}),v=new FileReader;v.readAsDataURL(u),v.onload=function(L){let x=document.createElement("a");x.download=c,x.href=L.target.result,document.body.appendChild(x),x.click(),document.body.removeChild(x)}},l=(c,u)=>{console.log(c,u)},r=()=>{window.$dialog.create({showIcon:!1,title:"删除笔记？",content:"笔记删除后30天之内，可在回收站中进行恢复。",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{Ve({article_id:d.value.id}).then(c=>{if(c.code!==200)return!1;o.close()})}})},m=()=>{window.$message.info("开发中...")};return(c,u)=>{const v=V("v-md-editor"),L=V("n-icon"),x=te("loading");return b((a(),k("section",{class:j(["el-container section",{full:w.value}])},[t("main",In,[t("section",Wn,[t("header",Dn,[An,t("h4",{contenteditable:g.value,textContent:f(s.title),onKeydown:Y},null,40,Hn)]),i(o).view.editorMode=="preview"?(a(),k("header",Bn,[t("span",null,"分类: "+f(i(o).view.detail.class_name||"默认分类"),1),t("span",null,"最后更新于 "+f(i(o).view.detail.updated_at),1)])):q("",!0),t("main",Fn,[i(o).view.editorMode=="preview"?(a(),D(v,{key:0,modelValue:s.markdown,"onUpdate:modelValue":u[0]||(u[0]=I=>s.markdown=I),mode:"preview",height:"100%",onImageClick:l},null,8,["modelValue"])):(a(),D(v,{key:1,modelValue:s.markdown,"onUpdate:modelValue":u[1]||(u[1]=I=>s.markdown=I),mode:i(o).view.editorMode,height:"100%","left-toolbar":"undo redo h bold italic strikethrough quote ul ol table link image code preview","right-toolbar":"","disabled-menus":[],onSave:u[2]||(u[2]=I=>i(Z)(!1)),onChange:C,onUploadImage:y},null,8,["modelValue","mode"]))])])]),t("aside",Tn,[t("div",{class:"nav-item",onClick:_},[n(L,{class:"icon",size:"18",component:w.value?i(Xe):i(Ze)},null,8,["component"]),En]),b(t("div",{class:"nav-item",onClick:u[3]||(u[3]=I=>i(o).setEditorMode("edit"))},[n(L,{class:"icon",size:"18",component:i(ae)},null,8,["component"]),Un],512),[[S,i(o).view.editorMode=="preview"]]),b(t("div",{class:"nav-item",onClick:u[4]||(u[4]=I=>F(!0))},[n(L,{class:"icon",size:"18",component:i(ae)},null,8,["component"]),d.value.id==0&&s.markdown.length===0?(a(),k("p",Rn,"取消")):(a(),k("p",Zn,f(p.value?"保存中..":"保存"),1))],512),[[S,i(o).view.editorMode=="edit"]]),b(t("div",{class:j(["nav-item",{active:d.value.is_asterisk==1}]),onClick:$},[n(L,{class:"icon",size:"18",component:i(Ye)},null,8,["component"]),Kn],2),[[S,d.value.id]]),n(i(se),{overlap:!1,placement:"right",trigger:"click","show-arrow":!0,raw:!0,animated:!1},{trigger:M(()=>[b(t("div",{class:j(["nav-item",{active:i(o).view.detail.tags.length}])},[n(L,{class:"icon",size:"18",component:i(Ke)},null,8,["component"]),Xn],2),[[S,d.value.id]])]),default:M(()=>[n(Vn)]),_:1}),n(i(se),{placement:"left",trigger:"click","show-arrow":!0,raw:!0},{trigger:M(()=>[b(t("div",{class:j(["nav-item",{active:i(o).view.detail.files.length}])},[n(L,{class:"icon",size:"18",component:i(Re)},null,8,["component"]),Pn],2),[[S,d.value.id]])]),default:M(()=>[n(yn)]),_:1}),b(t("div",{class:"nav-item",onClick:z},[n(L,{class:"icon",size:"18",component:i(Ue)},null,8,["component"]),Yn],512),[[S,d.value.id]]),b(t("div",{class:"nav-item",onClick:r},[n(L,{class:"icon",size:"18",component:i(ee)},null,8,["component"]),qn],512),[[S,d.value.id]]),b(t("div",{class:"nav-item",onClick:m},[n(L,{class:"icon",size:"18",component:i(He)},null,8,["component"]),On],512),[[S,d.value.id]])])],2)),[[x,h.value==0]])}}},Jn=E(Gn,[["__scopeId","data-v-63720759"]]);const Qn={},eo=e=>(U("data-v-eab574a1"),e=e(),R(),e),to={class:"section flex-center"},no=eo(()=>t("svg",{"data-v-09891987":"",focusable:"false",viewBox:"0 0 220 220","aria-hidden":"true",role:"presentation",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",width:"220",height:"220"},[t("g",null,[t("g",null,[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#F9FAFA",d:"M187.508,86.089l-84.87-49c-4.783-2.761-10.899-1.123-13.66,3.66 c-2.761,4.783-1.123,10.899,3.66,13.66l84.87,49c4.783,2.761,10.899,1.123,13.66-3.66 C193.929,94.966,192.291,88.85,187.508,86.089z M176.56,149.05l-30.311-17.5c4.783,2.761,10.899,1.122,13.66-3.66 c2.761-4.783,1.123-10.899-3.66-13.66L116.06,91.026l38.457,22.203c4.783,2.761,10.899,1.123,13.66-3.66 c2.761-4.783,1.123-10.899-3.66-13.66l-100.459-58c-4.783-2.761-10.899-1.123-13.66,3.66c-2.761,4.783-1.123,10.899,3.66,13.66 l6.929,4c4.782,2.762,6.421,8.877,3.66,13.66c-2.761,4.783-8.877,6.422-13.66,3.66l38.971,22.5l-65.818-38 c-4.783-2.761-10.899-1.123-13.66,3.66c-2.761,4.783-1.123,10.899,3.66,13.66l25.115,14.5c4.783,2.761,6.421,8.877,3.66,13.66 c-2.761,4.783-8.877,6.422-13.66,3.66l25.548,14.75l-26.414-15.25c-4.783-2.761-10.899-1.123-13.66,3.66 c-2.761,4.783-1.123,10.899,3.66,13.66l105.655,61c4.783,2.761,10.899,1.123,13.66-3.66c2.761-4.783,1.123-10.899-3.66-13.66 l-2.598-1.5c-4.783-2.761-6.422-8.877-3.66-13.66c2.761-4.783,8.877-6.422,13.66-3.66l25.115,14.5 c4.783,2.761,10.899,1.123,13.66-3.66C182.982,157.927,181.343,151.811,176.56,149.05z"})])]),t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#FFFFFF",d:"M56.375,71h91v68h-91V71z"}),t("g",null,[t("g",null,[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#D1D1D1",d:"M201.75,85.25c-2.761,0-5,2.239-5,5s2.239,5,5,5s5-2.239,5-5 S204.511,85.25,201.75,85.25z M201.75,94.25c-2.209,0-4-1.791-4-4s1.791-4,4-4s4,1.791,4,4S203.959,94.25,201.75,94.25z M24.75,64.25c-1.657,0-3,1.343-3,3c0,1.657,1.343,3,3,3s3-1.343,3-3C27.75,65.593,26.407,64.25,24.75,64.25z M24.75,69.25 c-1.105,0-2-0.895-2-2s0.895-2,2-2s2,0.895,2,2S25.855,69.25,24.75,69.25z M196.75,144.25c-1.657,0-3,1.343-3,3 c0,1.657,1.343,3,3,3s3-1.343,3-3C199.75,145.593,198.407,144.25,196.75,144.25z M196.75,149.25c-1.105,0-2-0.895-2-2s0.895-2,2-2 s2,0.895,2,2S197.855,149.25,196.75,149.25z M186.75,173.25c-2.761,0-5,2.239-5,5s2.239,5,5,5s5-2.239,5-5 S189.511,173.25,186.75,173.25z M186.75,182.25c-2.209,0-4-1.791-4-4s1.791-4,4-4s4,1.791,4,4S188.959,182.25,186.75,182.25z"})])]),t("g",{opacity:"0.6"},[t("g",null,[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#CBCBCB",d:"M207.85,164.1c-0.331,0-0.6,0.269-0.6,0.6v3.8 c0,0.331,0.269,0.6,0.6,0.6c0.331,0,0.6-0.269,0.6-0.6v-3.8C208.45,164.369,208.181,164.1,207.85,164.1z M83.85,29.1 c-0.331,0-0.6,0.269-0.6,0.6v3.8c0,0.331,0.269,0.6,0.6,0.6c0.331,0,0.6-0.269,0.6-0.6v-3.8C84.45,29.369,84.181,29.1,83.85,29.1z M158.85,169.1c-0.331,0-0.6,0.269-0.6,0.6v5.8c0,0.331,0.269,0.6,0.6,0.6c0.331,0,0.6-0.269,0.6-0.6v-5.8 C159.45,169.369,159.181,169.1,158.85,169.1z"})])]),t("g",{opacity:"0.8"},[t("g",null,[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#CCCCCC",d:"M209.45,166.095h-3.2c-0.221,0-0.4,0.226-0.4,0.505 s0.179,0.505,0.4,0.505h3.2c0.221,0,0.4-0.226,0.4-0.505S209.671,166.095,209.45,166.095z M85.45,31.095h-3.2 c-0.221,0-0.4,0.226-0.4,0.505s0.179,0.505,0.4,0.505h3.2c0.221,0,0.4-0.226,0.4-0.505S85.671,31.095,85.45,31.095z M161.45,172.095h-5.2c-0.221,0-0.4,0.226-0.4,0.505s0.179,0.505,0.4,0.505h5.2c0.221,0,0.4-0.226,0.4-0.505 S161.671,172.095,161.45,172.095z"})])]),t("g",{opacity:"0.5"},[t("g",null,[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#CBCBCB",d:"M51.583,50.917h-8c-0.552,0-1,0.448-1,1c0,0.552,0.448,1,1,1h8 c0.552,0,1-0.448,1-1C52.583,51.364,52.136,50.917,51.583,50.917z M192.583,102.917h-8c-0.552,0-1,0.448-1,1c0,0.552,0.448,1,1,1 h8c0.552,0,1-0.448,1-1C193.583,103.364,193.136,102.917,192.583,102.917z"})])]),t("g",{opacity:"0.5"},[t("g",null,[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#CBCBCB",d:"M47.583,46.917c-0.552,0-1,0.448-1,1v8c0,0.552,0.448,1,1,1 s1-0.448,1-1v-8C48.583,47.364,48.136,46.917,47.583,46.917z M188.583,98.917c-0.552,0-1,0.448-1,1v8c0,0.552,0.448,1,1,1 s1-0.448,1-1v-8C189.583,99.364,189.136,98.917,188.583,98.917z"})])]),t("g",null,[t("g",null,[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#CCCCCC",d:"M89.25,91h-25v3h25V91z M64.25,116h30v-3h-30V116z M86.25,102 h-22v3h22V102z M79.25,80h-15v3h15V80z M112.25,68c0,0-4.343,0-6,0h-1c-2.447,0-3.482,1.687-3.482,3c0-1.181-1.064-3-3.518-3h-2 c-1.657,0-6,0-6,0h-37v74h46c0.625,0,1,0.483,1,1h3c0-0.544,0.428-1,1-1h46V68H112.25z M100.25,75c0,1.105,0,64,0,64h-44V71h34 c0,0,4.895,0,6,0h2c1.105,0,2,0.895,2,2V75z M147.25,139h-44c0,0,0-62.895,0-64v-2c0-1.105,0.895-2,2-2h2c1.105,0,5,0,5,0h35V139z M111.25,127h25v-3h-25V127z M111.25,94h14V80h-14V94z M114.25,83h8v8h-8V83z M111.25,116h30v-3h-30V116z M111.25,105h20v-3h-20 V105z M64.25,127h15v-3h-15V127z"})])]),t("g",{opacity:"0.2"},[t("g",null,[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#CCCCCC",d:"M41.333,29.083c-2.209,0-4,1.791-4,4s1.791,4,4,4s4-1.791,4-4 S43.542,29.083,41.333,29.083z M41.333,36.095c-1.663,0-3.012-1.348-3.012-3.012c0-1.663,1.349-3.012,3.012-3.012 c1.663,0,3.012,1.349,3.012,3.012C44.345,34.747,42.997,36.095,41.333,36.095z"})])])],-1)),oo=[no];function io(e,o){return a(),k("section",to,oo)}const so=E(Qn,[["render",io],["__scopeId","data-v-eab574a1"]]),lo={class:"el-container height100"},ao={class:"el-aside",style:{width:"230px"}},co={class:"el-aside",style:{width:"350px"}},ro={class:"el-main"},Lo={__name:"index",setup(e){const o=P(),w=X(()=>o.view.loadId);return(d,s)=>{const h=te("dropsize");return a(),k("section",lo,[t("aside",ao,[n(Bt)]),b((a(),k("aside",co,[n(on)])),[[h,{min:200,max:500,direction:"right"}]]),t("main",ro,[(a(),D(Ie(w.value>0?Jn:so)))])])}}};export{Lo as default};
