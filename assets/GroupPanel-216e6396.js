import{I as ye,g as t,_ as q,r as G,m as Y,p as j,b as N,ab as we,c as _,e as P,w as s,f as e,A as T,k as V,i as $,a as l,a0 as X,ae as ie,F as R,y as H,t as I,N as de,W as te,X as B,l as W,bZ as $e,a1 as oe,b_ as xe,b$ as Ce,c0 as Se,o as Ie,c1 as ae,c2 as Ne,K as Z,L as J,d as ue,s as _e,aA as pe,Z as K,v as O,C as Ge,E as De,c3 as me,c4 as ce,n as Te,c5 as ze,c6 as Me,c7 as Le,c8 as Ue,bJ as ve,ay as Ae,c9 as Pe,at as je,bY as Re,V as Ve,bX as Be,bS as he,bD as re,ca as Ee,cb as Fe,cc as Oe,j as We,z as Xe,x as qe,b9 as He,a8 as Ye,aI as Ke,cd as Ze}from"./index-da544b70.js";import{_ as se}from"./no-data-bde0995b.js";import{S as Q}from"./Search-70006e83.js";import{I as Je}from"./Delete-4648d4a5.js";import{A as Qe,R as et}from"./AvatarCropper-22942329.js";import{P as le}from"./Plus-ab114cb2.js";import{C as tt}from"./CheckSmall-33b85732.js";import{C as fe}from"./Close-7f5ea69c.js";const st=ye("comment",!0,function(n){return t("svg",{width:n.size,height:n.size,viewBox:"0 0 48 48",fill:"none"},[t("path",{d:"M44 6H4V36H13V41L23 36H44V6Z",fill:n.colors[1],stroke:n.colors[0],"stroke-width":n.strokeWidth,"stroke-linecap":n.strokeLinecap,"stroke-linejoin":n.strokeLinejoin},null),t("path",{d:"M14 19.5V22.5",stroke:n.colors[2],"stroke-width":n.strokeWidth,"stroke-linecap":n.strokeLinecap,"stroke-linejoin":n.strokeLinejoin},null),t("path",{d:"M24 19.5V22.5",stroke:n.colors[2],"stroke-width":n.strokeWidth,"stroke-linecap":n.strokeLinecap,"stroke-linejoin":n.strokeLinejoin},null),t("path",{d:"M34 19.5V22.5",stroke:n.colors[2],"stroke-width":n.strokeWidth,"stroke-linecap":n.strokeLinecap,"stroke-linejoin":n.strokeLinejoin},null)])});const nt={class:"el-container launch-box"},ot={class:"el-aside bdr-r",style:{width:"280px"}},at={class:"el-container is-vertical height100"},lt={class:"el-header",style:{height:"50px",padding:"16px"}},it={class:"el-main o-hidden"},ct={class:"friend-items"},rt=["onClick"],dt={class:"avatar"},ut={class:"content"},_t={class:"text-ellipsis"},pt={class:"checkbox"},mt={class:"el-main"},vt={class:"el-container is-vertical height100"},ht={key:0,class:"el-header",style:{height:"90px",padding:"10px 15px"}},ft={class:"el-header",style:{height:"50px"}},gt={class:"el-main o-hidden"},kt={class:"friend-items"},bt=["onClick"],yt={class:"avatar"},wt={class:"content"},$t={class:"text-ellipsis"},xt={class:"checkbox"},Ct={class:"footer"},St={__name:"GroupLaunch",props:{gid:{type:Number,default:0}},emits:["close","on-submit"],setup(n,{emit:S}){const k=S,u=n,d=G([]),c=Y({keywords:"",name:""}),p=G(!0),m=G(!0),b=j(()=>c.keywords?d.value.filter(x=>x.nickname.match(c.keywords)!=null):d.value),o=j(()=>d.value.filter(x=>x.checked)),h=j(()=>u.gid>0?!o.value.length:!(c.name.trim()&&o.value.length)),r=()=>{c.name="",d.value.forEach(x=>{x.checked=!1})},C=()=>{xe({group_id:u.gid}).then(x=>{if(x.code==200&&x.data){let f=x.data||[];d.value=f.map(g=>Object.assign(g,{nickname:g.friend_remark?g.friend_remark:g.nickname,checked:!1}))}}).finally(()=>{p.value=!1})},D=()=>{k("close")},v=x=>{let f=d.value.find(g=>g.id===x.id);f&&(f.checked=!f.checked)},U=x=>{Ce({avatar:"",name:c.name,profile:"",ids:x.join(",")}).then(f=>{f.code==200&&(r(),k("on-submit",f.data),window.$message.success("创建成功"),m.value=!1)})},w=x=>{Se({group_id:u.gid,ids:x.join(",")}).then(f=>{f.code==200&&(k("on-invite"),window.$message.success("邀请成功"),m.value=!1)})},A=()=>{let x=o.value.map(f=>f.id);u.gid==0?U(x):w(x)};return C(),(x,f)=>{const g=N("n-icon"),y=N("im-avatar"),F=N("n-button"),a=we("loading");return _(),P(l(oe),{show:m.value,"onUpdate:show":f[3]||(f[3]=i=>m.value=i),preset:"card",title:n.gid==0?"创建群聊":"邀请新的联系人",class:"modal-radius",style:{"max-width":"650px",height:"550px"},"on-after-leave":D,segmented:{content:!0,footer:!0},"content-style":{padding:0}},{footer:s(()=>[e("div",Ct,[t(F,{type:"tertiary",onClick:f[2]||(f[2]=i=>m.value=!1)},{default:s(()=>[T(" 取消 ")]),_:1}),t(F,{type:"primary",class:"mt-l15",onClick:A,disabled:h.value},{default:s(()=>[T(" 提交 ")]),_:1},8,["disabled"])])]),default:s(()=>[e("section",nt,[V((_(),$("aside",ot,[e("section",at,[e("header",lt,[t(l(X),{placeholder:"搜索",value:c.keywords,"onUpdate:value":f[0]||(f[0]=i=>c.keywords=i),clearable:""},{prefix:s(()=>[t(g,{component:l(Q)},null,8,["component"])]),_:1},8,["value"])]),e("main",it,[t(l(ie),null,{default:s(()=>[e("div",ct,[(_(!0),$(R,null,H(b.value,i=>(_(),$("div",{class:"friend-item pointer",key:i.id,onClick:L=>v(i)},[e("div",dt,[t(y,{class:"pointer",src:i.avatar,size:25,username:i.nickname},null,8,["src","username"])]),e("div",ut,[e("span",_t,I(i.nickname),1)]),e("div",pt,[t(l(de),{size:"small",checked:i.checked,"onUpdate:checked":L=>i.checked=!i.checked},null,8,["checked","onUpdate:checked"])])],8,rt))),128))])]),_:1})])])])),[[a,p.value]]),e("main",mt,[e("section",vt,[u.gid===0?(_(),$("header",ht,[t(l(te),null,{default:s(()=>[t(l(B),{label:"群聊名称",required:!0},{default:s(()=>[t(l(X),{value:c.name,"onUpdate:value":f[1]||(f[1]=i=>c.name=i),placeholder:"必填",maxlength:"20","show-count":""},null,8,["value"])]),_:1})]),_:1})])):W("",!0),e("header",ft,[t(l($e),{"title-placement":"left",style:{"margin-top":"15px","margin-bottom":"0","font-weight":"300"}},{default:s(()=>[T(" 邀请成员("+I(o.value.length)+") ",1)]),_:1})]),e("main",gt,[t(l(ie),null,{default:s(()=>[e("div",kt,[(_(!0),$(R,null,H(o.value,i=>(_(),$("div",{class:"friend-item pointer",key:i.id,onClick:L=>v(i)},[e("div",yt,[t(y,{class:"pointer",src:i.avatar,size:25,username:i.nickname},null,8,["src","username"])]),e("div",wt,[e("span",$t,I(i.nickname),1)]),e("div",xt,[t(g,{size:16,component:l(Je)},null,8,["component"])])],8,bt))),128))])]),_:1})])])])])]),_:1},8,["show","title"])}}},ge=q(St,[["__scopeId","data-v-fb68e50a"]]);const It=n=>(Z("data-v-1c4323f9"),n=n(),J(),n),Nt={class:"section el-container is-vertical height100"},Gt=It(()=>e("header",{class:"el-header header bdr-b"},[e("p",null,"基础信息")],-1)),Dt={class:"el-main main"},Tt={__name:"DetailTab",props:{id:{type:Number,default:0}},setup(n){const S=n,k=G(!1),u=Y({name:"",avatar:"",profile:""}),d=m=>{k.value=!1,u.avatar=m,p()},c=()=>{ae({group_id:S.id}).then(m=>{m.code==200&&(u.name=m.data.group_name,u.avatar=m.data.avatar,u.profile=m.data.profile)})};function p(){if(u.name.trim()=="")return window.$message.info("群名称不能为空");Ne({group_id:S.id,group_name:u.name,avatar:u.avatar,profile:u.profile}).then(m=>{m.code==200?window.$message.success("群信息更新成功"):window.$message.error(m.message)})}return Ie(()=>{c()}),(m,b)=>{const o=N("n-avatar"),h=N("n-button");return _(),$(R,null,[e("section",Nt,[Gt,e("main",Dt,[t(l(te),{ref:"formRef",style:{minWinth:"350px",maxWidth:"350px"}},{default:s(()=>[t(l(B),{label:"群头像",path:"name"},{default:s(()=>[u.avatar?(_(),P(o,{key:0,size:60,src:u.avatar},null,8,["src"])):(_(),P(o,{key:1,size:60,style:{color:"white",backgroundColor:"#508afe",fontSize:"18px"}},{default:s(()=>[T(I(u.name.substring(0,1)),1)]),_:1})),t(h,{type:"primary",size:"tiny",style:{"margin-left":"20px"},dashed:"",onClick:b[0]||(b[0]=r=>k.value=!0)},{default:s(()=>[T(" 上传头像 ")]),_:1})]),_:1}),t(l(B),{label:"群名称",required:"",path:"name"},{default:s(()=>[t(l(X),{placeholder:"必填",type:"text",value:u.name,"onUpdate:value":b[1]||(b[1]=r=>u.name=r)},null,8,["value"])]),_:1}),t(l(B),{label:"群简介",path:"profile"},{default:s(()=>[t(l(X),{placeholder:"选填",type:"textarea",value:u.profile,"onUpdate:value":b[2]||(b[2]=r=>u.profile=r)},null,8,["value"])]),_:1}),t(l(B),{label:""},{default:s(()=>[t(h,{type:"primary",onClick:p},{default:s(()=>[T(" 保存信息 ")]),_:1})]),_:1})]),_:1},512)])]),k.value?(_(),P(Qe,{key:0,onClose:b[3]||(b[3]=r=>k.value=!1),onSuccess:d})):W("",!0)],64)}}},zt=q(Tt,[["__scopeId","data-v-1c4323f9"]]),Mt=n=>(Z("data-v-1326702f"),n=n(),J(),n),Lt={class:"el-container is-vertical height100"},Ut={class:"el-header header bdr-b"},At={key:0,class:"el-main main flex-center"},Pt=Mt(()=>e("img",{src:se,alt:""},null,-1)),jt={key:1,class:"el-main main me-scrollbar me-scrollbar-thumb"},Rt={class:"tool flex-center"},Vt=["onClick"],Bt=["onClick","onContextmenu"],Et={class:"item-title"},Ft={class:"nickname text-ellipsis"},Ot={class:"badge master"},Wt={class:"badge leader"},Xt={class:"badge muted"},qt={class:"item-text text-ellipsis"},Ht={class:"el-footer footer bdr-t"},Yt={class:"tips"},Kt=ue({__name:"MemberTab",props:{id:{type:Number,default:0}},setup(n){const S=n,k=_e("$user"),u=pe(),d=G(!1),c=G(""),p=G(!1),m=G([]),b=j(()=>m.value.filter(a=>a.is_delete)),o=j(()=>c.value.length?m.value.filter(a=>a.nickname.match(c.value)!=null||a.remark.match(c.value)!=null):m.value),h=j(()=>m.value.some(a=>a.user_id==u.uid&&a.leader==2)),r=Y({options:[],show:!1,dropdownX:0,dropdownY:0,item:{}}),C=()=>{me({group_id:S.id}).then(a=>{if(a.code==200){let i=a.data.items||[];i.forEach(L=>{L.is_delete=!1}),m.value=i}})},D=a=>{let i=`删除 [${a.nickname}] 群成员？`;window.$dialog.create({title:"温馨提示",content:i,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{ce({group_id:S.id,members_ids:`${a.user_id}`}).then(L=>{L.code==200&&(C(),window.$message.success("删除成功"))})}})},v=()=>{b.value.length&&window.$dialog.create({title:"温馨提示",content:"批量删除群成员？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{ce({group_id:S.id,members_ids:b.value.map(a=>a.user_id).join(",")}).then(a=>{a.code==200&&(p.value=!1,C(),window.$message.success("删除成功"))})}})},U=a=>{p.value==!0?a.leader<2&&(a.is_delete=!a.is_delete):k(a.user_id)},w=()=>{m.value.forEach(a=>{a.is_delete=!1}),p.value=!1},A=a=>{k(a.user_id)},x=a=>{let i=a.leader==0?`确定要给 [${a.nickname}] 分配管理员权限吗？`:`确定解除 [${a.nickname}] 管理员权限吗？`;window.$dialog.create({title:"温馨提示",content:i,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{ze({mode:a.leader==0?1:2,group_id:S.id,user_id:parseInt(a.user_id)}).then(L=>{L.code==200?(window.$message.success("操作成功"),C()):window.$message.error(L.message)})}})},f=a=>{window.$dialog.create({title:"温馨提示",content:`确定把群主权限转交给 [${a.nickname}] ？`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{Me({group_id:S.id,user_id:parseInt(a.user_id)}).then(i=>{i.code==200?(window.$message.success("操作成功"),C()):window.$message.error(i.message)})}})},g=a=>{let i=`确定要禁言 [${a.nickname}] 此用户吗？`;a.is_mute===1&&(i=`确定要解除 [${a.nickname}] 此用户的禁言吗？`),window.$dialog.create({title:"温馨提示",content:i,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{Le({mode:a.is_mute==0?1:2,group_id:S.id,user_id:parseInt(a.user_id)}).then(L=>{L.code==200?(window.$message.success("操作成功"),C()):window.$message.error(L.message)})}})},y=(a,i)=>{p.value==!0||i.leader==2||(r.show=!1,r.item=Object.assign({},i),r.options=[{label:"查看成员",key:"info"},{label:i.is_mute?"解除禁言":"禁止发言",key:"forbidden"},{label:"删除成员",key:"delete"},{label:"批量删除",key:"batch_delete"}],h.value&&(r.options.push({label:"转让群主",key:"transfer"}),i.leader==1?r.options.push({label:"管理权限(解除)",key:"assignment"}):i.leader==0&&r.options.push({label:"管理权限(分配)",key:"assignment"})),Te(()=>{r.show=!0,r.dropdownX=a.clientX,r.dropdownY=a.clientY}),a.preventDefault())},F=a=>{const i={info:A,assignment:x,transfer:f,forbidden:g,delete:D,batch_delete:L=>{p.value=!0}};r.show=!1,i[a]&&i[a](r.item)};return C(),(a,i)=>{const L=N("n-icon"),z=N("n-input"),ee=N("n-button"),ke=N("n-empty"),be=N("im-avatar");return _(),$(R,null,[e("section",Lt,[e("header",Ut,[e("p",null,"成员管理("+I(o.value.length)+")",1),e("div",null,[t(l(K),null,{default:s(()=>[t(z,{placeholder:"搜索",value:c.value,"onUpdate:value":i[0]||(i[0]=M=>c.value=M),valueModifiers:{trim:!0},clearable:"",style:{width:"200px"},round:""},{prefix:s(()=>[t(L,{component:l(Q)},null,8,["component"])]),_:1},8,["value"]),t(ee,{circle:"",onClick:i[1]||(i[1]=M=>d.value=!0)},{icon:s(()=>[t(L,{component:l(le)},null,8,["component"])]),_:1})]),_:1})])]),o.value.length===0?(_(),$("main",At,[t(ke,{size:"200",description:"暂无相关数据"},{icon:s(()=>[Pt]),_:1})])):(_(),$("main",jt,[(_(!0),$(R,null,H(o.value,M=>(_(),$("div",{class:"member-item",key:M.user_id},[V(e("div",Rt,[t(l(de),{disabled:M.leader===2,size:"small",checked:M.is_delete},null,8,["disabled","checked"])],512),[[O,p.value]]),e("div",{class:"avatar pointer",onClick:ne=>A(M)},[t(be,{size:40,src:M.avatar,username:M.nickname},null,8,["src","username"])],8,Vt),e("div",{class:"content pointer o-hidden",onClick:ne=>U(M),onContextmenu:Ge(ne=>y(ne,M),["prevent"])},[e("div",Et,[e("p",Ft,[e("span",null,I(M.nickname||"未设置昵称"),1),V(e("span",null," ("+I(M.user_card)+")",513),[[O,M.user_card]])]),e("p",null,[V(e("span",Ot,"群主",512),[[O,M.leader==2]]),V(e("span",Wt,"管理员",512),[[O,M.leader==1]]),V(e("span",Xt,"已禁言",512),[[O,M.is_mute==1]])])]),e("div",qt,I(M.motto||"暂无简介"),1)],40,Bt)]))),128))])),V(e("footer",Ht,[e("div",Yt,"已选("+I(b.value.length)+")",1),e("div",null,[t(l(K),null,{default:s(()=>[t(ee,{type:"primary",ghost:"",size:"small",onClick:w},{default:s(()=>[T(" 取消 ")]),_:1}),t(ee,{color:"red",size:"small",onClick:v},{default:s(()=>[T(" 批量删除 ")]),_:1})]),_:1})])],512),[[O,p.value]])]),t(l(De),{show:r.show,x:r.dropdownX,y:r.dropdownY,placement:"right",options:r.options,onSelect:F,onClickoutside:i[2]||(i[2]=()=>{r.show=!1,r.item={}})},null,8,["show","x","y","options"]),d.value?(_(),P(ge,{key:0,gid:n.id,onClose:i[3]||(i[3]=M=>d.value=!1),onOnInvite:C},null,8,["gid"])):W("",!0)],64)}}});const Zt=q(Kt,[["__scopeId","data-v-1326702f"]]),Jt={style:{width:"100%","text-align":"right"}},Qt={__name:"NoticeEditor",props:{id:{type:Number,default:0},gid:{type:Number,default:0},title:{type:String,default:""},content:{type:String,default:""}},emits:["close","success"],setup(n,{emit:S}){const k=S,u=n,d=G(u.id==0?"发布群公告":"编辑群公告"),c=G(),p=Y({title:u.title,content:u.content}),m={title:{required:!0,trigger:["blur","input"],message:"标题不能为空！"},content:{required:!0,trigger:["blur","input"],message:"内容不能为空！"}},b=G(!0),o=G(!1),h=()=>{k("close")},r=()=>{o.value=!0;let D=Ue({notice_id:u.id,group_id:u.gid,title:p.title,content:p.content,is_top:0,is_confirm:0});D.then(v=>{v.code==200?(window.$message.success(v.message),k("success")):window.$message.warning(v.message)}),D.finally(()=>{o.value=!1})},C=D=>{D.preventDefault(),c.value.validate(v=>{!v&&r()})};return(D,v)=>{const U=N("n-button");return _(),P(l(oe),{show:b.value,"onUpdate:show":v[2]||(v[2]=w=>b.value=w),preset:"card",title:d.value,size:"huge",style:{"max-width":"450px","border-radius":"10px"},"on-after-leave":h},{footer:s(()=>[e("div",Jt,[t(U,{type:"tertiary",onClick:h},{default:s(()=>[T(" 取消 ")]),_:1}),t(U,{type:"primary",class:"mt-l15",loading:o.value,onClick:C},{default:s(()=>[T(" 确定 ")]),_:1},8,["loading"])])]),default:s(()=>[t(l(te),{ref_key:"formRef",ref:c,model:p,rules:m},{default:s(()=>[t(l(B),{label:"标题",path:"title"},{default:s(()=>[t(l(X),{placeholder:"必填",type:"text",value:p.title,"onUpdate:value":v[0]||(v[0]=w=>p.title=w)},null,8,["value"])]),_:1}),t(l(B),{label:"内容",path:"content"},{default:s(()=>[t(l(X),{placeholder:"必填",type:"textarea",value:p.content,"onUpdate:value":v[1]||(v[1]=w=>p.content=w),autosize:{minRows:5,maxRows:10}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])}}};const es=n=>(Z("data-v-1fa3dd27"),n=n(),J(),n),ts={class:"section el-container is-vertical height100"},ss={class:"el-header header bdr-b"},ns={key:0,class:"el-main main flex-center"},os=es(()=>e("img",{src:se,alt:""},null,-1)),as={key:1,class:"el-main main me-scrollbar me-scrollbar-thumb"},ls=["onClick"],is={class:"content pointer o-hidden"},cs={class:"item-title"},rs={class:"nickname text-ellipsis"},ds={class:"date"},us={class:"item-text text-ellipsis"},_s={class:"el-footer footer bdr-t"},ps={class:"tips"},ms={__name:"NoticeTab",props:{id:{type:Number,default:0}},setup(n){const S=n,k=G(""),u=G(!1),d=G([]),c=Y({isShow:!1,id:0,gid:0,title:"",content:""}),p=j(()=>d.value.filter(v=>v.is_delete)),m=j(()=>k.value.length?d.value.filter(v=>v.title.match(k.value)!=null):d.value),b=()=>{Ae({group_id:S.id}).then(v=>{v.code==200&&(d.value=v.data.items||[])})},o=()=>{p.value.length&&p.value.map(v=>v.user_id).join(",")},h=v=>{u.value==!0?console.log(v):(c.id=v.id,c.gid=S.id,c.title=v.title,c.content=v.content,c.isShow=!0)},r=()=>{c.id=0,c.gid=S.id,c.title="",c.content="",c.isShow=!0},C=()=>{d.value.forEach(v=>{v.is_delete=!1}),u.value=!1},D=()=>{c.isShow=!1,b()};return b(),(v,U)=>{const w=N("n-icon"),A=N("n-input"),x=N("n-button");return _(),$(R,null,[e("section",ts,[e("header",ss,[e("p",null,"公告管理("+I(m.value.length)+")",1),e("div",null,[t(l(K),null,{default:s(()=>[t(A,{placeholder:"搜索",value:k.value,"onUpdate:value":U[0]||(U[0]=f=>k.value=f),valueModifiers:{trim:!0},clearable:"",style:{width:"200px"},round:""},{prefix:s(()=>[t(w,{component:l(Q)},null,8,["component"])]),_:1},8,["value"]),t(x,{circle:"",onClick:r},{icon:s(()=>[t(w,{component:l(le)},null,8,["component"])]),_:1})]),_:1})])]),m.value.length===0?(_(),$("main",ns,[t(l(ve),{size:"200",description:"暂无相关数据"},{icon:s(()=>[os]),_:1})])):(_(),$("main",as,[(_(!0),$(R,null,H(m.value,f=>(_(),$("div",{class:"member-item bdr-b",key:f.id,onClick:g=>h(f)},[e("div",is,[e("div",cs,[e("p",rs,[e("span",null,I(f.title),1)]),e("p",null,[e("span",ds,I(f.updated_at),1)])]),e("div",us,I(f.content),1)])],8,ls))),128))])),V(e("footer",_s,[e("div",ps,"已选("+I(p.value.length)+")",1),e("div",null,[t(l(K),null,{default:s(()=>[t(x,{type:"primary",ghost:"",size:"small",onClick:C},{default:s(()=>[T(" 取消 ")]),_:1}),t(x,{type:"error",size:"small",onClick:o},{default:s(()=>[T(" 删除 ")]),_:1})]),_:1})])],512),[[O,u.value]])]),c.isShow?(_(),P(Qt,{key:0,id:c.id,gid:c.gid,title:c.title,content:c.content,onSuccess:D,onClose:U[1]||(U[1]=f=>c.isShow=!1)},null,8,["id","gid","title","content"])):W("",!0)],64)}}},vs=q(ms,[["__scopeId","data-v-1fa3dd27"]]);const hs=n=>(Z("data-v-a81386ff"),n=n(),J(),n),fs={class:"section el-container is-vertical height100"},gs={class:"el-header header bdr-b"},ks={key:0,class:"el-main main flex-center"},bs=hs(()=>e("img",{src:se,alt:""},null,-1)),ys={key:1,class:"el-main main me-scrollbar me-scrollbar-thumb"},ws=["onClick"],$s={class:"content pointer o-hidden"},xs={class:"item-title"},Cs={class:"nickname text-ellipsis"},Ss={class:"date mt-l15"},Is={class:"item-text text-ellipsis"},Ns={class:"tool flex-center"},Gs={__name:"ApplyTab",props:{id:{type:Number,default:0}},setup(n){const S=n,k=G(""),u=G(!1),d=G([]),c=j(()=>k.value.length?d.value.filter(h=>h.nickname.match(k.value)!=null):d.value),p=()=>{Pe({group_id:S.id}).then(h=>{if(h.code==200){let r=h.data.items||[];d.value=r}})},m=h=>{u.value==!0&&console.log(h)},b=je(h=>{let r=window.$message.loading("请稍等，正在处理");Re({apply_id:h.id}).then(C=>{r.destroy(),C.code==200?window.$message.success("已同意"):window.$message.info(C.message),p()})},1e3),o=h=>{let r="",C=window.$dialog.create({title:"拒绝入群申请",content:()=>Ve(X,{defaultValue:"",placeholder:"请填写拒绝原因",style:{marginTop:"20px"},onInput:D=>r=D,autofocus:!0}),negativeText:"取消",positiveText:"提交",onPositiveClick:()=>(r.length&&(C.loading=!0,Be({apply_id:h.id,remark:r}).then(D=>{C.destroy(),D.code==200?window.$message.success("已拒绝"):window.$message.info(D.message),p()})),!1)})};return p(),(h,r)=>{const C=N("n-icon"),D=N("n-button"),v=N("n-empty"),U=N("im-avatar");return _(),$("section",fs,[e("header",gs,[e("p",null,"申请管理("+I(c.value.length)+")",1),e("div",null,[t(l(K),null,{default:s(()=>[t(l(X),{placeholder:"搜索",value:k.value,"onUpdate:value":r[0]||(r[0]=w=>k.value=w),valueModifiers:{trim:!0},clearable:"",style:{width:"200px"},round:""},{prefix:s(()=>[t(C,{component:l(Q)},null,8,["component"])]),_:1},8,["value"]),t(D,{circle:"",onClick:p},{icon:s(()=>[t(C,{component:l(et)},null,8,["component"])]),_:1})]),_:1})])]),c.value.length===0?(_(),$("main",ks,[t(v,{size:"200",description:"暂无相关数据"},{icon:s(()=>[bs]),_:1})])):(_(),$("main",ys,[(_(!0),$(R,null,H(c.value,w=>(_(),$("div",{class:"member-item",key:w.id,onClick:A=>m(w)},[e("div",{class:"avatar pointer",onClick:r[1]||(r[1]=A=>h.onUserInfo(h.member))},[t(U,{size:40,src:w.avatar,username:w.nickname},null,8,["src","username"])]),e("div",$s,[e("div",xs,[e("p",Cs,[e("span",null,I(w.nickname),1),e("span",Ss,I(w.created_at),1)])]),e("div",Is,"备注: "+I(w.remark),1)]),e("div",Ns,[t(l(K),null,{default:s(()=>[t(D,{onClick:A=>l(b)(w),strong:"",secondary:"",circle:"",type:"primary",size:"small"},{icon:s(()=>[t(C,{component:l(tt)},null,8,["component"])]),_:2},1032,["onClick"]),t(D,{onClick:A=>o(w),strong:"",secondary:"",circle:"",type:"tertiary",size:"small"},{icon:s(()=>[t(C,{component:l(fe)},null,8,["component"])]),_:2},1032,["onClick"])]),_:2},1024)])],8,ws))),128))]))])}}},Ds=q(Gs,[["__scopeId","data-v-a81386ff"]]);const Ts=n=>(Z("data-v-ba788dae"),n=n(),J(),n),zs={class:"section el-container is-vertical height100"},Ms=Ts(()=>e("header",{class:"el-header header bdr-b"},[e("p",null,"设置管理")],-1)),Ls={class:"el-main main"},Us={__name:"ConfigTab",props:{id:{type:Number,default:0}},emits:["close"],setup(n,{emit:S}){const k=S,u=n,d=Y({is_mute:!1,mute_loading:!1,is_overt:!1,overt_loading:!1}),c=()=>{ae({group_id:u.id}).then(o=>{o.code==200&&(d.is_mute=o.data.is_mute==1,d.is_overt=o.data.is_overt==1)})},p=()=>{Ee({group_id:u.id}).then(o=>{o.code==200?(window.$message.success("群聊已解散"),k("close")):window.$message.info(o.message)})},m=o=>{d.mute_loading=!0,Fe({group_id:u.id,mode:d.is_mute?2:1}).then(({code:h,message:r})=>{h==200?d.is_mute=o:window.$message.info(r)}).finally(()=>{d.mute_loading=!1})},b=o=>{d.overt_loading=!0,Oe({group_id:u.id,mode:d.is_overt?2:1}).then(({code:h,message:r})=>{h==200?d.is_overt=o:window.$message.info(r)}).finally(()=>{d.overt_loading=!1})};return c(),(o,h)=>{const r=N("n-button");return _(),$("section",zs,[Ms,e("main",Ls,[t(l(te),{"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging"},{default:s(()=>[t(l(B),{label:"解散群聊:"},{default:s(()=>[t(l(he),{"negative-text":"取消","positive-text":"确定",onPositiveClick:p},{trigger:s(()=>[t(r,{type:"primary",size:"small",text:""},{default:s(()=>[T(" 点击解散 ")]),_:1})]),default:s(()=>[T(" 确定要解散群聊吗？ 此操作是不可逆的！ ")]),_:1})]),_:1}),t(l(B),{label:"公开可见:",feedback:"开启后可在公开群聊列表展示。"},{default:s(()=>[t(l(re),{"rubber-band":!1,value:d.is_overt,loading:d.overt_loading,"onUpdate:value":b},null,8,["value","loading"])]),_:1}),t(l(B),{label:"全员禁言:",feedback:"开启后除群主和管理员以外，其它成员禁止发言。"},{default:s(()=>[t(l(re),{"rubber-band":!1,value:d.is_mute,loading:d.mute_loading,"onUpdate:value":m},null,8,["value","loading"])]),_:1})]),_:1})])])}}},As=q(Us,[["__scopeId","data-v-ba788dae"]]);const Ps={class:"el-container container-box"},js={class:"el-aside bdr-r",style:{width:"100px"}},Rs=["textContent","onClick"],Vs={class:"el-main"},Bs={__name:"index",props:{gid:{type:Number,default:0}},emits:["close"],setup(n,{emit:S}){const k=S,u=G(!0),d=G(0),c=[{name:"群信息",component:zt},{name:"群成员",component:Zt},{name:"群公告",component:vs},{name:"群申请",component:Ds},{name:"群设置",component:As}],p=()=>{k("close")};return(m,b)=>(_(),P(l(oe),{show:u.value,"onUpdate:show":b[0]||(b[0]=o=>u.value=o),preset:"card",title:"群管理",class:"modal-radius",style:{"max-width":"800px"},"on-after-leave":p,segmented:{content:!0},"content-style":{padding:0}},{default:s(()=>[e("section",Ps,[e("aside",js,[(_(),$(R,null,H(c,(o,h)=>e("div",{key:o.name,class:We(["menu-list pointer",{selectd:d.value==h}]),textContent:I(o.name),onClick:r=>d.value=h},null,10,Rs)),64))]),e("main",Vs,[(_(),P(Xe(c[d.value].component),{id:n.gid,onClose:p},null,40,["id"]))])])]),_:1},8,["show"]))}},Es=q(Bs,[["__scopeId","data-v-d5d3145e"]]),E=n=>(Z("data-v-a14f9005"),n=n(),J(),n),Fs={class:"el-container is-vertical section"},Os={class:"el-header header bdr-b"},Ws=E(()=>e("div",{class:"center-text"},[e("span",null,"群信息")],-1)),Xs={class:"right-icon"},qs={class:"el-main main me-scrollbar me-scrollbar-thumb"},Hs={class:"info-box"},Ys={class:"b-box"},Ks=E(()=>e("div",{class:"block"},[e("div",{class:"title"},"群名称：")],-1)),Zs={class:"describe"},Js={class:"b-box"},Qs={class:"block"},en=E(()=>e("div",{class:"title"},"群名片：",-1)),tn={class:"text"},sn={style:{display:"flex"}},nn={class:"describe"},on={class:"b-box"},an={class:"block"},ln=E(()=>e("div",{class:"title"},"群成员：",-1)),cn={class:"text"},rn=E(()=>e("div",{class:"describe"},"群主已开启“新成员入群可查看所有聊天记录",-1)),dn={class:"b-box"},un=E(()=>e("div",{class:"block"},[e("div",{class:"title"},"群简介：")],-1)),_n={class:"describe"},pn={class:"b-box"},mn={class:"block"},vn=E(()=>e("div",{class:"title"},"群公告：",-1)),hn={class:"text"},fn=E(()=>e("div",{class:"describe"},"暂无群公告",-1)),gn={class:"member-box"},kn={class:"flex"},bn={class:"table"},yn=E(()=>e("div",{class:"theader"},[e("div",{class:"avatar"}),e("div",{class:"nickname"},"用户昵称"),e("div",{class:"card"},"群名片")],-1)),wn=["onClick"],$n={class:"avatar"},xn={class:"nickname text-ellipsis"},Cn={class:"badge master"},Sn={class:"badge leader"},In={class:"card text-ellipsis grey"},Nn={key:0,class:"mt-t20 pd-t20"},Gn=E(()=>e("img",{src:se,alt:""},null,-1)),Dn={class:"el-footer footer bdr-t"},Tn=ue({__name:"GroupPanel",props:{gid:{type:Number,default:0}},emits:["close","to-talk"],setup(n,{emit:S}){const k=pe(),u=_e("$user"),d=S,c=n;qe(c,()=>{U(),w()});const p=G(!1),m=G(!1),b=G(!1),o=Y({keywords:"",detail:{avatar:"",name:"",profile:"",visit_card:""},members:[],remark:""}),h=j(()=>o.keywords?o.members.filter(g=>g.nickname.match(o.keywords)!=null||g.remark.match(o.keywords)!=null):o.members),r=j(()=>o.members.some(g=>g.user_id==k.uid&&g.leader>=1)),C=j(()=>o.members.some(g=>g.user_id==k.uid&&g.leader==2)),D=()=>{},v=g=>{u(g.user_id)};function U(){ae({group_id:c.gid}).then(g=>{if(g.code==200){let y=g.data;o.detail.avatar=y.avatar,o.detail.name=y.group_name,o.detail.profile=y.profile,o.detail.visit_card=y.visit_card,o.remark=y.visit_card,y.notice&&(o.detail.group_notice=y.notice)}})}function w(){me({group_id:c.gid}).then(g=>{g.code==200&&(o.members=g.data.items||[])})}const A=()=>{d("close")},x=()=>{Ke({group_id:c.gid}).then(g=>{g.code==200?(window.$message.success("已退出群聊"),A()):window.$message.error(g.message)})},f=()=>{Ze({group_id:c.gid,visit_card:o.remark}).then(({code:g,message:y})=>{g==200?(p.value.setShow(!1),o.detail.visit_card=o.remark,window.$message.success("已更新群名片"),w()):window.$message.error(y)})};return U(),w(),(g,y)=>{const F=N("n-icon"),a=N("n-button"),i=N("n-input"),L=N("im-avatar");return _(),$(R,null,[e("section",Fs,[e("header",Os,[e("div",{class:"left-icon",onClick:y[0]||(y[0]=z=>d("to-talk"))},[t(F,{size:"21",component:l(st)},null,8,["component"])]),Ws,e("div",Xs,[t(F,{size:"21",component:l(fe),onClick:A},null,8,["component"])])]),e("main",qs,[e("div",Hs,[e("div",Ys,[Ks,e("div",Zs,I(o.detail.name),1)]),e("div",Js,[e("div",Qs,[en,e("div",tn,[t(l(Ye),{trigger:"click",placement:"left",ref_key:"editCardPopover",ref:p},{trigger:s(()=>[t(a,{type:"primary",text:""},{default:s(()=>[T(" 设置 ")]),_:1})]),header:s(()=>[T(" 设置我的群名片 ")]),default:s(()=>[e("div",sn,[t(i,{type:"text",placeholder:"设置我的群名片",autofocus:!0,maxlength:"10",value:o.remark,"onUpdate:value":y[1]||(y[1]=z=>o.remark=z),onKeydown:He(f,["enter"])},null,8,["value"]),t(a,{type:"primary",class:"mt-l5",onClick:f},{default:s(()=>[T(" 确定 ")]),_:1})])]),_:1},512)])]),e("div",nn,I(o.detail.visit_card||"未设置"),1)]),e("div",on,[e("div",an,[ln,e("div",cn,I(o.members.length)+"人",1)]),rn]),e("div",dn,[un,e("div",_n,I(o.detail.profile?o.detail.profile:"暂无群简介"),1)]),e("div",pn,[e("div",mn,[vn,e("div",hn,[t(a,{type:"primary",text:""},{default:s(()=>[T(" 更多 ")]),_:1})])]),fn])]),e("div",gn,[e("div",kn,[t(i,{placeholder:"搜索",value:o.keywords,"onUpdate:value":y[2]||(y[2]=z=>o.keywords=z),clearable:!0,round:""},{prefix:s(()=>[t(F,{component:l(Q)},null,8,["component"])]),_:1},8,["value"]),t(a,{onClick:y[3]||(y[3]=z=>m.value=!0),circle:"",class:"mt-l15"},{icon:s(()=>[t(F,{component:l(le),color:"rgb(165 165 170)"},null,8,["component"])]),_:1})]),e("div",bn,[yn,(_(!0),$(R,null,H(h.value,z=>(_(),$("div",{class:"row pointer",key:z.id,onClick:ee=>v(z)},[e("div",$n,[t(L,{size:20,src:z.avatar,username:z.nickname},null,8,["src","username"])]),e("div",xn,[e("span",null,I(z.nickname?z.nickname:"-"),1),V(e("span",Cn,"群主",512),[[O,z.leader===2]]),V(e("span",Sn,"管理员",512),[[O,z.leader===1]])]),e("div",In,I(z.remark||"-"),1)],8,wn))),128)),h.value.length==0?(_(),$("div",Nn,[t(l(ve),{size:"200",description:"暂无相关数据"},{icon:s(()=>[Gn]),_:1})])):W("",!0)])])]),e("footer",Dn,[C.value?W("",!0):(_(),P(l(he),{key:0,"negative-text":"取消","positive-text":"确定",onPositiveClick:x},{trigger:s(()=>[t(a,{class:"btn",type:"error",ghost:""},{default:s(()=>[T(" 退出群聊 ")]),_:1})]),default:s(()=>[T(" 确定要退出群吗？ 退出后不再接收此群消息！ ")]),_:1})),r.value?(_(),P(a,{key:1,class:"btn",type:"primary","text-color":"#ffffff",onClick:y[4]||(y[4]=z=>b.value=!0)},{default:s(()=>[T(" 群聊管理 ")]),_:1})):W("",!0)])]),m.value?(_(),P(ge,{key:0,gid:n.gid,onClose:y[5]||(y[5]=z=>m.value=!1),onOnSubmit:D},null,8,["gid"])):W("",!0),b.value?(_(),P(Es,{key:1,gid:n.gid,onClose:y[6]||(y[6]=z=>b.value=!1)},null,8,["gid"])):W("",!0)],64)}}});const Vn=q(Tn,[["__scopeId","data-v-a14f9005"]]);export{Vn as G,ge as a};
