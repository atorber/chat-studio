(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ded8f098"],{2934:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"a",(function(){return n}));var r=s("b775");const i=e=>Object(r["b"])("/api/v1/common/sms-code",e),n=e=>Object(r["b"])("/api/v1/common/email-code",e)},"61f7":function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return i}));const r=e=>/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((.[a-zA-Z0-9_-]{2,3}){1,2})$/.test(e),i=e=>/^1[0-9]{10}$/.test(e)},"6d75":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"login-box"}},[t("div",{staticClass:"header"},[e._v("账号注册")]),t("div",{staticClass:"main"},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{prop:"nickname"}},[t("el-input",{staticClass:"cuborder-radius",attrs:{placeholder:"用户昵称",maxlength:"11"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{staticClass:"cuborder-radius",attrs:{type:"password",placeholder:"密码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("el-form-item",{attrs:{prop:"password2"}},[t("el-input",{staticClass:"cuborder-radius",attrs:{type:"password",placeholder:"确认密码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.password2,callback:function(t){e.$set(e.form,"password2",t)},expression:"form.password2"}})],1),t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{staticClass:"cuborder-radius",attrs:{placeholder:"手机号",maxlength:"11"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{prop:"sms_code"}},[t("el-input",{staticClass:"cuborder-radius",staticStyle:{width:"205px"},attrs:{placeholder:"验证码(随意填写)",maxlength:"6"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.sms_code,callback:function(t){e.$set(e.form,"sms_code",t)},expression:"form.sms_code"}}),e.smsLock?t("div",{staticClass:"send-code-btn send-sms-disable"},[e._v(" 正在发送 ... ")]):0==e.smsLock&&null==e.smsLockObj.time?t("div",{staticClass:"send-code-btn",on:{click:e.sendSms}},[e._v(" 获取短信 ")]):t("div",{staticClass:"send-code-btn send-sms-disable"},[e._v(" 重新发送("+e._s(e.smsLockObj.time)+"s) ")])],1),t("el-form-item",[t("el-button",{staticClass:"submit-btn",attrs:{type:"primary",loading:e.registerLoading},on:{click:function(t){return e.onSubmit("form")}}},[e._v(" 立即注册 ")])],1),t("el-form-item",[t("div",{staticClass:"links"},[t("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){return e.toLink("/auth/forget")}}},[e._v(" 找回密码 ")]),t("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){return e.toLink("/auth/login")}}},[e._v(" 已有账号，立即登录? ")])],1)])],1)],1)])},i=[],n=(s("d9e2"),s("14d9"),s("2934")),o=s("3786"),a=s("61f7"),l=s("f977"),m={data(){let e=(e,t,s)=>{""!==t?Object(a["b"])(t)?s():s(new Error("手机号格式不正确！")):s(new Error("手机号不能为空！"))},t=(e,t,s)=>{""===t?s(new Error("请再次输入密码")):t!==this.form.password?s(new Error("两次输入密码不一致!")):s()};return{registerLoading:!1,form:{nickname:"",username:"",password:"",password2:"",sms_code:""},rules:{nickname:[{required:!0,message:"用户昵称不能为空!",trigger:"blur"}],username:[{validator:e,trigger:"blur"}],password:[{required:!0,message:"登录密码不能为空!",trigger:"blur"}],password2:[{validator:t,trigger:"blur"}],sms_code:[{required:!0,message:"验证码不能为空!",trigger:"blur"}]},smsLock:!1,smsLockObj:null}},created(){this.smsLockObj=new l["a"]("REGISTER_SMS",120)},destroyed(){this.smsLockObj.clearInterval()},methods:{toLink(e){this.$router.push({path:e})},onSubmit(e){if(this.registerLoading)return!1;this.$refs[e].validate(e=>{if(!e)return!1;this.registerLoading=!0,this.register()})},register(){Object(o["d"])({nickname:this.form.nickname,mobile:this.form.username,password:this.form.password,sms_code:this.form.sms_code,platform:"web"}).then(e=>{200==e.code?(this.$notify({title:"成功",message:"注册成功,快去登录吧...",type:"success"}),this.$refs.form.resetFields(),setTimeout(()=>{this.toLink("/auth/login")},1500)):this.$notify.info({title:"提示",message:e.message})}).catch(()=>{this.$notify({message:"网络错误,请稍后再试..."})}).finally(()=>{this.registerLoading=!1})},sendSms(){return!this.smsLock&&(Object(a["b"])(this.form.username)?(this.smsLock=!0,void Object(n["b"])({mobile:this.form.username,channel:"register"}).then(e=>{200==e.code?(this.$notify({title:"成功",message:"验证码发送成功...",type:"success"}),this.smsLockObj.start(),e.data.is_debug&&setTimeout(()=>{this.$notify({title:"提示",message:"已自动填充验证码"}),this.form.sms_code=e.data.sms_code},500)):this.$notify({title:"提示",message:e.message,customClass:"cus-notifyclass"})}).finally(()=>{this.smsLock=!1})):(this.$refs.form.validateField("username"),!1))}}},c=m,u=(s("d162"),s("2877")),d=Object(u["a"])(c,r,i,!1,null,null,null);t["default"]=d.exports},"9ae9":function(e,t,s){},d162:function(e,t,s){"use strict";s("9ae9")},f977:function(e,t,s){"use strict";var r=s("ade3");class i{constructor(e,t=60){Object(r["a"])(this,"time",null),Object(r["a"])(this,"timer",null),Object(r["a"])(this,"lockTime",60),Object(r["a"])(this,"lockName",""),this.lockTime=t,this.lockName="SMSLOCK_"+e,this.init()}start(e=null){this.time=null==e||e>=this.lockTime?this.lockTime:e,this.clearInterval(),this.timer=setInterval(()=>{if(0==this.time)return this.clearInterval(),this.time=null,void localStorage.removeItem(this.lockName);this.time--,localStorage.setItem(this.lockName,this.getTime()+this.time)},1e3)}init(){let e=localStorage.getItem(this.lockName);if(null==e)return;let t=e-this.getTime();t>0?this.start(t):localStorage.removeItem(this.lockName)}getTime(){return Math.floor((new Date).getTime()/1e3)}clearInterval(){clearInterval(this.timer)}}t["a"]=i}}]);